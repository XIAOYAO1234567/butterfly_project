// SLiM 3.x-compatible • WF model • NC_069110.1
initialize() {
    initializeSLiMModelType("WF");
    initializeSLiMOptions(keepPedigrees = T, nucleotideBased = T);

    initializeAncestralNucleotides("SLiM/NC_069110.1.upper.fna");

    initializeMutationTypeNuc("m1", 0.5, "f", 0.0);
    initializeMutationTypeNuc("m2", 0.5, "f", 0.1);
    initializeMutationTypeNuc("m3", 0.5, "f", -0.1);

    mm = mmJukesCantor(1e-7);

    initializeGenomicElementType("g1", m1, 1.0, mm);
    initializeGenomicElementType("g2", m2, 1.0, mm);
    initializeGenomicElementType("g3", m3, 1.0, mm);

    // Neutral
    initializeGenomicElement(g1, 21468243, 21498243);         // rest neutral

    // Balancing
    initializeGenomicElement(g3, 5630001, 5640000);         // 10 kb
    initializeGenomicElement(g3, 5920001, 6150000);         // 230 kb

    initializeRecombinationRate(1e-8);

    // Retain fixed alleles in output file
    m1.convertToSubstitution = F;
    m2.convertToSubstitution = F;
    m3.convertToSubstitution = F;
}

1 early() {
    
    sim.addSubpop("p1", 5);
}
10 late() {
    sim.subpopulations[0].outputVCFSample(
        5,
        filePath = "SLiM/NC_069110.1_10_generations.vcf"
    );
}
20 late() {
    sim.subpopulations[0].outputVCFSample(
        5,
        filePath = "SLiM/NC_069110.1_20_generations.vcf"
    );
}
30 late() {
    sim.subpopulations[0].outputVCFSample(
        5,
        filePath = "SLiM/NC_069110.1_30_generations.vcf"
    );
    sim.simulationFinished();
}
40 late() {
    sim.subpopulations[0].outputVCFSample(
        5,
        filePath = "SLiM/NC_069110.1_40_generations.vcf"
    );
    sim.simulationFinished();
}
50 late() {
    sim.subpopulations[0].outputVCFSample(
        5,
        filePath = "SLiM/NC_069110.1_50_generations.vcf"
    );
    sim.simulationFinished();
}
