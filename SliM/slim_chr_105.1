// SLiM 3.x-compatible • WF model • NC_069105.1
initialize() {
    initializeSLiMModelType("WF");
    initializeSLiMOptions(keepPedigrees = T, nucleotideBased = T);

    initializeAncestralNucleotides("SLiM/NC_069105.1/NC_069105.1.upper.fna");

    // Mutation types
    initializeMutationTypeNuc("m1", 0.5, "f", 0.0);    // neutral
    initializeMutationTypeNuc("m2", 1.0, "f", 0.25);   // sweep

    // Mutation model
    mm = mmJukesCantor(1e-7);

    // Genomic element types
    initializeGenomicElementType("g1", m1, 1.0, mm);   // neutral
    initializeGenomicElementType("g2", m2, 1.0, mm);   // sweep

    // Genomic elements
    initializeGenomicElement(g2, 5050001, 5070000);    // Sweep region 
    initializeGenomicElement(g1, 5150001, 5200000);    // Neutral region
    initializeGenomicElement(g1, 13224084, 13224085); 
    

    initializeRecombinationRate(1e-8);

    // Retain fixed alleles
    m1.convertToSubstitution = F;
    m2.convertToSubstitution = F;
}

1 early() {
    sim.addSubpop("p1", 5);

    p1.genomes.readFromVCF(filePath = "SLiM/NC_069105.1/NC_069105.1_MT1_neutral.cleaned.vcf", mutationType = m1);
    p1.genomes.readFromVCF(filePath = "SLiM/NC_069105.1/NC_069105.1_MT2_sweep.cleaned.vcf", mutationType = m2);
}

10 late() {
    sim.subpopulations[0].outputVCFSample(5, filePath = "SLiM/NC_069105.1/NC_069105.1_10_generations.vcf");
    p1.outputMSSample(10,replace = F,filePath = "SLiM/NC_069105.1/NC_069105.1_10_generations.ms"); 
}
20 late() {
    sim.subpopulations[0].outputVCFSample(5, filePath = "SLiM/NC_069105.1/NC_069105.1_20_generations.vcf");
    p1.outputMSSample(10,replace = F,filePath = "SLiM/NC_069105.1/NC_069105.1_20_generations.ms"); 
}
30 late() {
    sim.subpopulations[0].outputVCFSample(5, filePath = "SLiM/NC_069105.1/NC_069105.1_30_generations.vcf");
    p1.outputMSSample(10,replace = F,filePath = "SLiM/NC_069105.1/NC_069105.1_30_generations.ms"); 
}
40 late() {
    sim.subpopulations[0].outputVCFSample(5, filePath = "SLiM/NC_069105.1/NC_069105.1_40_generations.vcf");
    p1.outputMSSample(10,replace = F,filePath = "SLiM/NC_069105.1/NC_069105.1_40_generations.ms"); 
}
50 late() {
    sim.subpopulations[0].outputVCFSample(5, filePath = "SLiM/NC_069105.1/NC_069105.1_50_generations.vcf");
    p1.outputMSSample(10,replace = F,filePath = "SLiM/NC_069105.1/NC_069105.1_50_generations.ms"); 
    sim.simulationFinished();
}

